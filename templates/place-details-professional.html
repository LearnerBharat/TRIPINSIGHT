{% load static %}
{% load custom_filters %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ single_place.Name }} - TripInsight</title>
    <meta name="description" content="Explore {{ single_place.Name }} in {{ single_place.City }}, {{ single_place.State }}. Find details, reviews, nearby attractions and plan your visit.">
    <link rel="stylesheet" href="{% static 'css/navbar.css' %}">
    <link rel="stylesheet" href="{% static 'css/theme.css' %}">
    <link rel="stylesheet" href="{% static 'css/transitions.css' %}">
    <link rel="stylesheet" href="{% static 'css/reviews-enhanced.css' %}">
    <link rel="stylesheet" href="{% static 'css/best-time-enhanced.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="{% static 'js/navbar.js' %}" defer></script>
    <script src="{% static 'js/transitions.js' %}" defer></script>
    
    <style>
        /* Place Details Page Styles */
        body {
            padding-top: 70px;
        }
        
        /* Hero Section */
        .hero-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 60px;
            margin-top: 30px;
        }
        
        @media (max-width: 992px) {
            .hero-section {
                grid-template-columns: 1fr;
                gap: 20px;
                margin-bottom: 40px;
            }
            
            .place-image {
                height: 350px;
            }
            
            .place-info h1 {
                font-size: 2rem;
            }
        }
        
        .place-info {
            display: flex;
            flex-direction: column;
        }
        
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            color: var(--text-light);
        }
        
        .breadcrumb a {
            color: var(--text-light);
            transition: var(--transition);
        }
        
        .breadcrumb a:hover {
            color: var(--primary-color);
        }
        
        .breadcrumb i {
            font-size: 10px;
            color: var(--text-muted);
        }
        
        .place-info h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--secondary-color);
        }
        
        .location-meta {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
            color: var(--text-light);
        }
        
        .location-meta span {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .location-meta i {
            color: var(--primary-color);
        }
        
        .description {
            margin-bottom: 30px;
            line-height: 1.7;
            color: var(--text-light);
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .estimate-button, .save-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 20px;
            border-radius: var(--border-radius);
            font-weight: 500;
            font-size: 15px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .estimate-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }
        
        .estimate-button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--hover-shadow);
        }
        
        .save-button {
            background-color: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }
        
        .save-button:hover {
            background-color: var(--lightest-color);
            transform: translateY(-2px);
        }
        
        .cost-display {
            background-color: var(--lightest-color);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        
        .cost-display.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        .cost-loader {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            color: var(--text-light);
        }
        
        .loader {
            width: 20px;
            height: 20px;
            border: 2px solid var(--primary-light);
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .cost-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .cost-item {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 15px;
            box-shadow: var(--card-shadow);
        }
        
        .cost-item h4 {
            margin-bottom: 10px;
            color: var(--secondary-color);
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .cost-item h4 i {
            color: var(--primary-color);
        }
        
        .cost-item p {
            margin: 0;
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-dark);
        }
        
        .cost-item span {
            font-size: 14px;
            color: var(--text-light);
            font-weight: normal;
        }
        
        .total-cost {
            grid-column: 1 / -1;
            background-color: var(--lightest-color);
            border: 1px solid var(--primary-light);
        }
        
        .total-cost h4, .total-cost p {
            color: var(--primary-dark);
            font-size: 1.1em;
        }
        
        .cost-note {
            grid-column: 1 / -1;
            margin-top: 15px;
            padding: 10px;
            background-color: var(--lightest-color);
            border-radius: var(--border-radius);
            font-size: 14px;
            color: var(--text-light);
            text-align: center;
        }
        
        .cost-note i {
            color: var(--primary-color);
            margin-right: 5px;
        }
        
        .no-cost-data, .cost-error {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            text-align: center;
            grid-column: 1 / -1;
        }
        
        .no-cost-data i, .cost-error i {
            font-size: 36px;
            margin-bottom: 15px;
            color: var(--text-muted);
        }
        
        .cost-error i {
            color: #e74c3c;
        }
        
        .no-cost-data p, .cost-error p {
            margin-bottom: 20px;
            color: var(--text-light);
        }
        
        .btn-submit-review {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            background-color: var(--primary-color);
            color: white;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 500;
            margin-top: 10px;
            transition: var(--transition);
        }
        
        .btn-submit-review:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--hover-shadow);
        }
        
        .place-image {
            position: relative;
            border-radius: var(--border-radius);
            overflow: hidden;
            height: 450px;
            box-shadow: var(--card-shadow);
        }
        
        .place-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .place-image:hover img {
            transform: scale(1.05);
        }
        
        .image-overlay {
            position: absolute;
            bottom: 20px;
            right: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .place-image:hover .image-overlay {
            opacity: 1;
        }
        
        .gallery-button {
            background-color: rgba(255, 255, 255, 0.9);
            color: var(--primary-color);
            border: none;
            border-radius: var(--border-radius);
            padding: 10px 15px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }
        
        .gallery-button:hover {
            background-color: white;
            transform: translateY(-2px);
            box-shadow: var(--hover-shadow);
        }
        
        /* Tabs Section */
        .tabs-section {
            margin-bottom: 60px;
        }
        
        .tabs-nav {
            display: flex;
            border-bottom: 1px solid var(--medium-gray);
            margin-bottom: 30px;
        }
        
        .tab-button {
            padding: 15px 25px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            font-size: 16px;
            font-weight: 500;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .tab-button.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        
        .tab-button:hover:not(.active) {
            color: var(--text-color);
            border-bottom-color: var(--medium-gray);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        /* About Tab */
        .about-tab {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
        }
        
        @media (max-width: 992px) {
            .about-tab {
                grid-template-columns: 1fr;
            }
        }
        
        .about-content h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--secondary-color);
        }
        
        .about-content p {
            margin-bottom: 20px;
            line-height: 1.7;
            color: var(--text-light);
        }
        
        .highlights {
            margin-top: 30px;
        }
        
        .highlights h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--secondary-color);
        }
        
        .highlights-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .highlight-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background-color: var(--lightest-color);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }
        
        .highlight-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-shadow);
        }
        
        .highlight-item i {
            color: var(--primary-color);
            font-size: 20px;
        }
        
        .highlight-item span {
            font-weight: 500;
            color: var(--text-color);
        }
        
        .visitor-info {
            margin-top: 40px;
        }
        
        .visitor-info h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--secondary-color);
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .info-item {
            padding: 20px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
        }
        
        .info-item h4 {
            font-size: 16px;
            margin-bottom: 10px;
            color: var(--secondary-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .info-item h4 i {
            color: var(--primary-color);
        }
        
        .info-item p {
            margin: 0;
            color: var(--text-light);
        }
        
        /* Map & Locations Tab Styling */
        .map-locations-grid {
            display: grid;
            grid-template-columns: 3fr 2fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 992px) {
            .map-locations-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .map-container {
            height: 100%;
            min-height: 400px;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }
        
        .map-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .no-map-message {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            min-height: 400px;
            background-color: var(--lightest-color);
            border-radius: var(--border-radius);
            text-align: center;
            padding: 30px;
        }
        
        .no-map-message i {
            font-size: 48px;
            color: var(--text-muted);
            margin-bottom: 15px;
        }
        
        .poi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .poi-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 20px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }
        
        .poi-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--hover-shadow);
        }
        
        .poi-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--lightest-color);
            border-radius: 50%;
            color: var(--primary-color);
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .poi-content h4 {
            margin: 0 0 8px;
            font-size: 16px;
            color: var(--secondary-color);
        }
        
        .poi-content p {
            margin: 0;
            font-size: 14px;
            color: var(--text-light);
            line-height: 1.5;
        }
        
        /* Nearby Tab */
        .nearby-attractions h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--secondary-color);
        }
        
        .attractions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
        }
        
        @media (max-width: 768px) {
            .attractions-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .attractions-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .attraction-card {
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }
        
        .attraction-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--hover-shadow);
        }
        
        .attraction-img {
            height: 200px;
            position: relative;
        }
        
        .attraction-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .attraction-card:hover .attraction-img img {
            transform: scale(1.1);
        }
        
        .attraction-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: var(--primary-color);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .attraction-content {
            padding: 20px;
        }
        
        .attraction-content h4 {
            font-size: 18px;
            margin-bottom: 10px;
            color: var(--secondary-color);
            transition: var(--transition);
        }
        
        .attraction-card:hover .attraction-content h4 {
            color: var(--primary-color);
        }
        
        .attraction-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            color: var(--text-light);
            font-size: 14px;
        }
        
        .attraction-location, .attraction-rating {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .attraction-location i, .attraction-rating i {
            color: var(--primary-color);
        }
        
        .attraction-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 15px;
            border-top: 1px solid var(--light-gray);
        }
        
        .attraction-distance {
            font-size: 14px;
            color: var(--text-light);
        }
        
        .attraction-link {
            color: var(--primary-color);
            font-weight: 500;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: var(--transition);
        }
        
        .attraction-link:hover {
            color: var(--primary-dark);
        }
        
        .attraction-link i {
            transition: transform 0.3s ease;
        }
        
        .attraction-link:hover i {
            transform: translateX(3px);
        }
        
        /* Reviews Tab */
        .reviews-section h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--secondary-color);
        }
        
        .reviews-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .reviews-summary {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .overall-rating {
            text-align: center;
        }
        
        .rating-number {
            font-size: 48px;
            font-weight: 700;
            color: var(--primary-color);
            line-height: 1;
        }
        
        .rating-stars {
            color: #FFD700;
            font-size: 18px;
            margin: 5px 0;
        }
        
        .rating-count {
            font-size: 14px;
            color: var(--text-light);
        }
        
        .rating-breakdown {
            flex: 1;
            max-width: 300px;
        }
        
        .rating-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }
        
        .rating-label {
            display: flex;
            align-items: center;
            gap: 5px;
            width: 40px;
            font-size: 14px;
            color: var(--text-light);
        }
        
        .rating-label i {
            color: #FFD700;
            font-size: 12px;
        }
        
        .progress-bar {
            flex: 1;
            height: 8px;
            background-color: var(--light-gray);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background-color: var(--primary-color);
        }
        
        .rating-percentage {
            width: 40px;
            font-size: 14px;
            color: var(--text-light);
            text-align: right;
        }
        
        .write-review-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 12px 20px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }
        
        .write-review-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--hover-shadow);
        }
        
        .reviews-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .review-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--card-shadow);
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .reviewer-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .reviewer-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            overflow: hidden;
            background-color: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-size: 20px;
            font-weight: 600;
        }
        
        .reviewer-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .reviewer-details h4 {
            font-size: 16px;
            margin-bottom: 5px;
            color: var(--text-color);
        }
        
        .review-date {
            font-size: 14px;
            color: var(--text-light);
        }
        
        .review-rating {
            color: #FFD700;
            font-size: 16px;
        }
        
        .review-content {
            color: var(--text-light);
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .review-photos {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .review-photo {
            width: 80px;
            height: 80px;
            border-radius: var(--border-radius);
            overflow: hidden;
        }
        
        .review-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* Best Time Tab */
        .best-time-tab h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--secondary-color);
        }
        
        .season-info {
            margin-bottom: 40px;
        }
        
        .season-info p {
            margin-bottom: 20px;
            line-height: 1.7;
            color: var(--text-light);
        }
        
        .month-map {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 768px) {
            .month-map {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 576px) {
            .month-map {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .month {
            padding: 15px;
            border-radius: var(--border-radius);
            text-align: center;
            transition: var(--transition);
        }
        
        .month:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-shadow);
        }
        
        .month.low {
            background-color: #e8f5e9;
            border: 1px solid #c8e6c9;
        }
        
        .month.medium {
            background-color: #fff9c4;
            border: 1px solid #fff59d;
        }
        
        .month.high {
            background-color: #ffebee;
            border: 1px solid #ffcdd2;
        }
        
        .month span {
            display: block;
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 5px;
            color: var(--text-color);
        }
        
        .month .crowd-level {
            font-size: 14px;
            color: var(--text-light);
        }
        
        .month.low .crowd-level {
            color: #2e7d32;
        }
        
        .month.medium .crowd-level {
            color: #f9a825;
        }
        
        .month.high .crowd-level {
            color: #c62828;
        }
        
        .weather-info {
            margin-top: 40px;
        }
        
        .weather-info h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--secondary-color);
        }
        
        .weather-info p {
            margin-bottom: 20px;
            line-height: 1.7;
            color: var(--text-light);
        }
        
        .weather-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .weather-card {
            padding: 20px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            text-align: center;
        }
        
        .weather-card h4 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--secondary-color);
        }
        
        .weather-icon {
            font-size: 36px;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .weather-temp {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-color);
        }
        
        .weather-desc {
            font-size: 14px;
            color: var(--text-light);
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Map & Locations Tab - Enhanced Styling */
        .map-locations-section {
            display: flex;
            flex-direction: column;
            gap: 40px;
            padding: 10px 0 30px;
        }
        
        /* Section Headers */
        .section-header-enhanced {
            margin-bottom: 25px;
            position: relative;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .section-header-enhanced h3 {
            font-size: 1.6rem;
            color: var(--secondary-color);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-header-enhanced h3 i {
            color: var(--primary-color);
            font-size: 1.2rem;
        }
        
        .section-header-enhanced p {
            color: var(--text-light);
            margin: 0;
            font-size: 1rem;
        }
        
        /* Map Section */
        .map-section-container {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--card-shadow);
            margin-bottom: 20px;
        }
        
        .map-container {
            height: 450px;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border: 1px solid var(--light-gray);
        }
        
        .map-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .no-map-message {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            background-color: var(--lightest-color);
            border-radius: var(--border-radius);
            text-align: center;
            padding: 40px;
        }
        
        .no-map-message i {
            font-size: 48px;
            color: var(--primary-color);
            margin-bottom: 20px;
            opacity: 0.8;
        }
        
        .no-map-message p {
            color: var(--text-color);
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 10px;
        }
        
        .map-note {
            color: var(--text-light);
            font-size: 14px;
        }
        
        /* Location Info Container */
        .location-info-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 40px;
        }
        
        @media (min-width: 992px) {
            .location-info-container {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        /* Points of Interest */
        .nearby-section, .travel-tips-section {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--card-shadow);
        }
        
        .poi-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        @media (min-width: 768px) {
            .poi-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .poi-item {
            display: flex;
            flex-direction: column;
            padding: 25px;
            background-color: var(--lightest-color);
            border-radius: var(--border-radius);
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            border: 1px solid transparent;
            height: 100%;
        }
        
        .poi-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--hover-shadow);
            border-color: var(--primary-light);
        }
        
        .poi-icon {
            width: 60px;
            height: 60px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
            border: 1px solid var(--primary-light);
        }
        
        .poi-icon i {
            font-size: 24px;
            color: var(--primary-color);
        }
        
        .poi-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .poi-content h4 {
            font-size: 18px;
            margin-bottom: 10px;
            color: var(--secondary-color);
        }
        
        .poi-content p {
            margin: 0 0 15px;
            color: var(--text-light);
            font-size: 14px;
            line-height: 1.5;
            flex: 1;
        }
        
        .poi-link {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: var(--primary-color);
            font-weight: 500;
            font-size: 14px;
            text-decoration: none;
            margin-top: auto;
            transition: all 0.2s ease;
        }
        
        .poi-link i {
            font-size: 12px;
            transition: transform 0.2s ease;
        }
        
        .poi-link:hover {
            color: var(--primary-dark);
        }
        
        .poi-link:hover i {
            transform: translateX(3px);
        }
        
        /* Travel Tips */
        .tips-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        @media (min-width: 768px) {
            .tips-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .tip-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 20px;
            background-color: var(--lightest-color);
            border-radius: var(--border-radius);
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        
        .tip-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--hover-shadow);
            border-color: var(--primary-light);
        }
        
        .tip-icon {
            width: 45px;
            height: 45px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
            border: 1px solid var(--primary-light);
        }
        
        .tip-icon i {
            font-size: 20px;
            color: var(--primary-color);
        }
        
        .tip-content {
            flex: 1;
        }
        
        .tip-content h4 {
            font-size: 16px;
            margin-bottom: 8px;
            color: var(--secondary-color);
        }
        
        .tip-content p {
            margin: 0;
            color: var(--text-light);
            font-size: 14px;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    {% include 'includes/notifications.html' %}

    <div class="container">
        <!-- Hero Section -->
        <div class="hero-section">
            <div class="place-info">
                <div class="breadcrumb">
                    <a href="{% url 'index' %}">Home</a> <i class="fas fa-chevron-right"></i>
                    <a href="{% url 'explore' %}">Explore</a> <i class="fas fa-chevron-right"></i>
                    <span>{{ single_place.Name }}</span>
                </div>
                <h1>{{ single_place.Name }}</h1>
                <div class="location-meta">
                    <span class="location">
                        <i class="fas fa-map-marker-alt"></i> {{ single_place.City }}, {{ single_place.State }}
                    </span>
                    <span class="rating">
                        <i class="fas fa-star"></i> {{ single_place.Google_rating|default:"N/A" }} (Google rating)
                    </span>
                </div>
                <p class="description" style="white-space: pre-wrap; line-height: 1.6; max-width: 100%; word-wrap: break-word;">
                    {{ single_place.Description }}
                </p>
                <div class="action-buttons">
                    <button class="estimate-button" id="estimateCostBtn">
                        <i class="fas fa-calculator"></i> Estimate Cost
                    </button>
                </div>
                <div id="cost-display" class="cost-display">
                    <div class="cost-loader">
                        <div class="loader"></div>
                        <span>Calculating...</span>
                    </div>
                    <div class="cost-results">
                        <!-- Cost results will be populated here -->
                    </div>
                </div>
            </div>
            <div class="place-image">
                <img src="{{ single_place.Image_url }}" alt="{{ single_place.Name }}">
                <div class="image-overlay">
                    <button class="gallery-button">
                        <i class="fas fa-images"></i> View Gallery
                    </button>
                </div>
            </div>
        </div>

        <!-- Tabs Section -->
        <div class="tabs-section">
            <div class="tabs-nav">
                <button class="tab-button active" data-tab="nearby">Nearby Attractions</button>
                <button class="tab-button" data-tab="reviews">Reviews</button>
                <button class="tab-button" data-tab="best-time">Best Time to Visit</button>
                <button class="tab-button" data-tab="map-locations">Map & Locations</button>
            </div>

            <!-- Nearby Attractions Tab -->
            <div class="tab-content active" id="nearby-tab">
                <div class="nearby-attractions">
                    <h3>Nearby Attractions</h3>
                    <div class="attractions-grid">
                        {% for place in rec_places %}
                        <div class="attraction-card">
                            <div class="attraction-img">
                                <img src="{{ place.Image_url }}" alt="{{ place.Name }}">
                                <div class="attraction-badge">Popular</div>
                            </div>
                            <div class="attraction-content">
                                <h4>{{ place.Name }}</h4>
                                <div class="attraction-meta">
                                    <div class="attraction-location">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <span>{{ place.City }}, {{ place.State }}</span>
                                    </div>
                                    <div class="attraction-rating">
                                        <i class="fas fa-star"></i>
                                        <span>4.7 ({{ forloop.counter|add:100 }})</span>
                                    </div>
                                </div>
                                <p>{{ place.Description|truncatechars:100 }}</p>
                                <div class="attraction-footer">
                                    <div class="attraction-distance">
                                        <i class="fas fa-route"></i> Nearby attraction
                                    </div>
                                    <a href="{% url 'details' pk=place.id %}" class="attraction-link">
                                        Explore <i class="fas fa-arrow-right"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Reviews Tab -->
            <div class="tab-content" id="reviews-tab">
                <div class="reviews-section">
                    <div class="reviews-header">
                        <div class="reviews-summary">
                            {% if reviews %}
                                {% with avg_rating=reviews|avg_rating review_count=reviews|length %}
                                <div class="overall-rating">
                                    <div class="rating-number">{{ avg_rating|floatformat:1 }}</div>
                                    <div class="rating-stars">
                                        {% for i in "12345" %}
                                            {% if forloop.counter <= avg_rating|floatformat:0 %}
                                                <i class="fas fa-star"></i>
                                            {% elif forloop.counter <= avg_rating|add:0.5|floatformat:0 %}
                                                <i class="fas fa-star-half-alt"></i>
                                            {% else %}
                                                <i class="far fa-star"></i>
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                    <div class="rating-count">{{ review_count }} review{{ review_count|pluralize }}</div>
                                </div>
                                {% endwith %}
                                
                                <div class="rating-breakdown">
                                    {% for i in "54321" %}
                                        {% with rating_count=reviews|filter_by_rating:forloop.counter|length percentage=reviews|rating_percentage:forloop.counter %}
                                        <div class="rating-bar">
                                            <div class="rating-label">
                                                <i class="fas fa-star"></i> {{ forloop.counter }}
                                            </div>
                                            <div class="progress-bar">
                                                <div class="progress" style="width: {{ percentage }}%"></div>
                                            </div>
                                            <div class="rating-percentage">{{ percentage }}%</div>
                                        </div>
                                        {% endwith %}
                                    {% endfor %}
                                </div>
                            {% else %}
                                <div class="overall-rating">
                                    <div class="rating-number">-</div>
                                    <div class="rating-stars">
                                        <i class="far fa-star"></i>
                                        <i class="far fa-star"></i>
                                        <i class="far fa-star"></i>
                                        <i class="far fa-star"></i>
                                        <i class="far fa-star"></i>
                                    </div>
                                    <div class="rating-count">No reviews yet</div>
                                </div>
                            {% endif %}
                        </div>
                        {% if user.is_authenticated %}
                        <a href="{% url 'submit_trip_review' pk=single_place.id %}" class="write-review-btn">
                            <i class="fas fa-pen"></i> Share Your Story
                        </a>
                        {% else %}
                        <a href="{% url 'login' %}?next={% url 'submit_trip_review' pk=single_place.id %}" class="write-review-btn">
                            <i class="fas fa-sign-in-alt"></i> Login to Share Your Story
                        </a>
                        {% endif %}
                    </div>
                    <div class="reviews-list">
                        {% if reviews %}
                            {% for review in reviews %}
                            <div class="review-card">
                                <div class="review-header">
                                    <div class="reviewer-info">
                                        <div class="reviewer-avatar">
                                            <i class="fas fa-user"></i>
                                        </div>
                                        <div class="reviewer-details">
                                            <h4>{{ review.user.username }}</h4>
                                            <div class="review-date">{{ review.created_at|date:"F j, Y" }}</div>
                                        </div>
                                    </div>
                                    <div class="review-rating">
                                        {% for i in "12345" %}
                                            {% if forloop.counter <= review.rating %}
                                                <i class="fas fa-star"></i>
                                            {% else %}
                                                <i class="far fa-star"></i>
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                </div>
                                <div class="review-content">
                                    <div class="review-text" style="white-space: pre-wrap; line-height: 1.6; max-width: 100%; word-wrap: break-word;">{{ review.description }}</div>
                                    
                                    <div class="review-details">
                                        <div class="review-detail">
                                            <i class="fas fa-users"></i> Group Size: {{ review.no_of_people }}
                                        </div>
                                        <div class="review-detail">
                                            <i class="fas fa-plane-departure"></i> Travel: {{ review.travel_medium }}
                                        </div>
                                        <div class="review-detail">
                                            <i class="fas fa-ticket-alt"></i> Travel Cost: ₹{{ review.travel_cost }}
                                        </div>
                                        <div class="review-detail">
                                            <i class="fas fa-hotel"></i> Accommodation: ₹{{ review.accommodation_cost }}
                                        </div>
                                        <div class="review-detail">
                                            <i class="fas fa-utensils"></i> Food: ₹{{ review.food_cost }}
                                        </div>
                                    </div>
                                    

                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="no-reviews">
                                <i class="fas fa-comment-slash"></i>
                                <p>No reviews yet. Be the first to share your experience!</p>
                                {% if user.is_authenticated %}
                                <a href="{% url 'submit_trip_review' pk=single_place.id %}" class="write-review-btn" style="margin-top: 15px;">
                                    <i class="fas fa-pen"></i> Share Your Story
                                </a>
                                {% else %}
                                <a href="{% url 'login' %}?next={% url 'submit_trip_review' pk=single_place.id %}" class="write-review-btn" style="margin-top: 15px;">
                                    <i class="fas fa-sign-in-alt"></i> Login to Share Your Story
                                </a>
                                {% endif %}
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Best Time to Visit Tab -->
            <div class="tab-content" id="best-time-tab">
                <div class="best-time-section">
                    <h3>Best Time to Visit</h3>
                    <div class="season-info">
                        <p style="white-space: pre-wrap; line-height: 1.6; max-width: 100%; word-wrap: break-word;">The best time to visit {{ single_place.Name }} is during the winter months from October to March when the weather is pleasant for sightseeing. The summer months from April to June can be extremely hot, while the monsoon season from July to September brings heavy rainfall. Evening visits are recommended as the area is beautifully illuminated and the atmosphere is more relaxed with fewer crowds.</p>
                    </div>
                    
                    <h3>Visitor Traffic by Month</h3>
                    <div class="month-legend">
                        <div class="legend-item">
                            <span class="legend-color low"></span>
                            <span class="legend-text">Optimal Season</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color medium"></span>
                            <span class="legend-text">Favorable Period</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color high"></span>
                            <span class="legend-text">Peak Tourist Season</span>
                        </div>
                    </div>
                    <div class="month-map">
                        {% for i in crowd_data %}
                        {% if i.crowd_count == 1 %}
                        <div class="month low">
                            <span>{{ i.month_name }}</span>
                            <div class="crowd-level">Optimal</div>
                        </div>
                        {% elif i.crowd_count == 2 %}
                        <div class="month medium">
                            <span>{{ i.month_name }}</span>
                            <div class="crowd-level">Favorable</div>
                        </div>
                        {% else %}
                        <div class="month high">
                            <span>{{ i.month_name }}</span>
                            <div class="crowd-level">Peak Season</div>
                        </div>
                        {% endif %}
                        {% endfor %}
                    </div>
                    
                    <div class="weather-info">
                        <h3>Weather Information</h3>
                        <p>{{ single_place.Name }} experiences weather patterns typical of {{ single_place.State }}. Here's what to expect throughout the year:</p>
                        
                        <div class="weather-grid">
                            {% if single_place.State == "Rajasthan" or single_place.State == "Gujarat" or single_place.State == "Delhi" or single_place.State == "Haryana" or single_place.State == "Punjab" %}
                                <!-- North & Western India Weather -->
                                <div class="weather-card">
                                    <h4>Winter (Nov-Feb)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-sun"></i>
                                    </div>
                                    <div class="weather-temp">5°C - 20°C</div>
                                    <div class="weather-desc">Cool & Pleasant</div>
                                </div>
                                
                                <div class="weather-card">
                                    <h4>Summer (Mar-Jun)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-temperature-high"></i>
                                    </div>
                                    <div class="weather-temp">35°C - 48°C</div>
                                    <div class="weather-desc">Very Hot & Dry</div>
                                </div>
                                
                                <div class="weather-card">
                                    <h4>Monsoon (Jul-Sep)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-cloud-rain"></i>
                                    </div>
                                    <div class="weather-temp">25°C - 35°C</div>
                                    <div class="weather-desc">Moderate Rainfall</div>
                                </div>
                            {% elif single_place.State == "Kerala" or single_place.State == "Karnataka" or single_place.State == "Tamil Nadu" or single_place.State == "Andhra Pradesh" or single_place.State == "Goa" %}
                                <!-- South India Weather -->
                                <div class="weather-card">
                                    <h4>Winter (Dec-Feb)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-sun"></i>
                                    </div>
                                    <div class="weather-temp">20°C - 30°C</div>
                                    <div class="weather-desc">Warm & Pleasant</div>
                                </div>
                                
                                <div class="weather-card">
                                    <h4>Summer (Mar-May)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-temperature-high"></i>
                                    </div>
                                    <div class="weather-temp">30°C - 40°C</div>
                                    <div class="weather-desc">Hot & Humid</div>
                                </div>
                                
                                <div class="weather-card">
                                    <h4>Monsoon (Jun-Sep)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-cloud-showers-heavy"></i>
                                    </div>
                                    <div class="weather-temp">25°C - 30°C</div>
                                    <div class="weather-desc">Heavy Rainfall</div>
                                </div>
                            {% elif single_place.State == "Himachal Pradesh" or single_place.State == "Uttarakhand" or single_place.State == "Jammu and Kashmir" or single_place.State == "Sikkim" %}
                                <!-- Himalayan Region Weather -->
                                <div class="weather-card">
                                    <h4>Winter (Nov-Feb)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-snowflake"></i>
                                    </div>
                                    <div class="weather-temp">-10°C - 10°C</div>
                                    <div class="weather-desc">Cold & Snowy</div>
                                </div>
                                
                                <div class="weather-card">
                                    <h4>Summer (Mar-Jun)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-sun"></i>
                                    </div>
                                    <div class="weather-temp">15°C - 30°C</div>
                                    <div class="weather-desc">Pleasant & Cool</div>
                                </div>
                                
                                <div class="weather-card">
                                    <h4>Monsoon (Jul-Sep)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-cloud-rain"></i>
                                    </div>
                                    <div class="weather-temp">10°C - 25°C</div>
                                    <div class="weather-desc">Rainy & Landslides</div>
                                </div>
                            {% else %}
                                <!-- Default/Central India Weather -->
                                <div class="weather-card">
                                    <h4>Winter (Nov-Feb)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-sun"></i>
                                    </div>
                                    <div class="weather-temp">10°C - 25°C</div>
                                    <div class="weather-desc">Pleasant & Comfortable</div>
                                </div>
                                
                                <div class="weather-card">
                                    <h4>Summer (Mar-Jun)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-temperature-high"></i>
                                    </div>
                                    <div class="weather-temp">30°C - 42°C</div>
                                    <div class="weather-desc">Hot & Dry</div>
                                </div>
                                
                                <div class="weather-card">
                                    <h4>Monsoon (Jul-Sep)</h4>
                                    <div class="weather-icon">
                                        <i class="fas fa-cloud-rain"></i>
                                    </div>
                                    <div class="weather-temp">25°C - 35°C</div>
                                    <div class="weather-desc">Humid & Rainy</div>
                                </div>
                            {% endif %}
                            
                            <div class="weather-card">
                                <h4>Post-Monsoon (Oct-Nov)</h4>
                                <div class="weather-icon">
                                    <i class="fas fa-cloud-sun"></i>
                                </div>
                                <div class="weather-temp">20°C - 30°C</div>
                                <div class="weather-desc">Pleasant & Clear</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Region-specific travel advice -->
                    <div class="region-weather">
                        <h3>Regional Travel Tips</h3>
                        <div class="region-tabs">
                            <button class="region-tab active" data-region="general">General</button>
                            <button class="region-tab" data-region="clothing">What to Pack</button>
                            <button class="region-tab" data-region="activities">Activities</button>
                            <button class="region-tab" data-region="festivals">Festivals</button>
                        </div>
                        
                        <div class="region-content active" id="general-content">
                            <div class="region-info">
                                <p>{{ single_place.Name }} is best visited during the winter months when the weather is most comfortable for sightseeing and outdoor activities. If you're planning to visit during monsoon, be prepared for occasional travel disruptions.</p>
                                
                                {% if crowd_data %}
                                    {% with low_crowd_months=crowd_data|dictsortreversed:"crowd_count"|slice:":3" %}
                                        {% if low_crowd_months %}
                                            <p>The months with typically lower visitor traffic are:
                                            {% for month in low_crowd_months %}
                                                {{ month.month_name }}{% if not forloop.last %}{% if forloop.counter == low_crowd_months|length|add:"-1" %} and {% else %}, {% endif %}{% endif %}
                                            {% endfor %}
                                            making them ideal for a more peaceful experience.</p>
                                        {% endif %}
                                    {% endwith %}
                                {% else %}
                                    <p>For the most comfortable experience, consider visiting outside of peak holiday seasons and weekends.</p>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="region-content" id="clothing-content">
                            <div class="region-info">
                                <p>What to pack for your visit to {{ single_place.Name }} depends on the season:</p>
                                
                                {% if single_place.State == "Himachal Pradesh" or single_place.State == "Uttarakhand" or single_place.State == "Jammu and Kashmir" or single_place.State == "Sikkim" %}
                                    <!-- Himalayan Region Packing -->
                                    <ul>
                                        <li><strong>Winter:</strong> Heavy woolens, thermal wear, snow boots, gloves, muffler, warm cap</li>
                                        <li><strong>Summer:</strong> Light woolens for evenings, comfortable walking shoes, sunglasses, sunscreen</li>
                                        <li><strong>Monsoon:</strong> Waterproof jacket, umbrella, waterproof hiking boots, quick-dry clothes</li>
                                    </ul>
                                {% elif single_place.State == "Rajasthan" or single_place.State == "Gujarat" %}
                                    <!-- Desert Region Packing -->
                                    <ul>
                                        <li><strong>Winter:</strong> Light to medium woolens, jacket, comfortable walking shoes</li>
                                        <li><strong>Summer:</strong> Lightweight cotton clothes, scarf/hat for sun protection, sunglasses, high SPF sunscreen, water bottle</li>
                                        <li><strong>Monsoon:</strong> Light cotton clothes, umbrella, waterproof footwear</li>
                                    </ul>
                                {% elif single_place.State == "Kerala" or single_place.State == "Goa" %}
                                    <!-- Coastal Region Packing -->
                                    <ul>
                                        <li><strong>Winter:</strong> Light cotton clothes, light jacket for evenings, comfortable sandals</li>
                                        <li><strong>Summer:</strong> Lightweight breathable clothes, swimwear, hat, sunglasses, high SPF sunscreen, insect repellent</li>
                                        <li><strong>Monsoon:</strong> Quick-dry clothes, umbrella, waterproof sandals, rain jacket, insect repellent</li>
                                    </ul>
                                {% else %}
                                    <!-- Default Packing List -->
                                    <ul>
                                        <li><strong>Winter:</strong> Light woolens, jacket, comfortable walking shoes</li>
                                        <li><strong>Summer:</strong> Light cotton clothes, sunglasses, hat, sunscreen, water bottle</li>
                                        <li><strong>Monsoon:</strong> Umbrella, raincoat, waterproof footwear, quick-dry clothes</li>
                                    </ul>
                                {% endif %}
                                
                                <p class="mt-3"><strong>General items:</strong> Comfortable walking shoes, basic medications, camera, power bank, and appropriate clothing for religious sites (covered shoulders and knees).</p>
                            </div>
                        </div>
                        
                        <div class="region-content" id="activities-content">
                            <div class="region-info">
                                <p>Seasonal activities in and around {{ single_place.Name }}:</p>
                                
                                {% if single_place.State == "Himachal Pradesh" or single_place.State == "Uttarakhand" or single_place.State == "Jammu and Kashmir" or single_place.State == "Sikkim" %}
                                    <!-- Himalayan Region Activities -->
                                    <ul>
                                        <li><strong>Winter:</strong> Snow activities (skiing, snowboarding), winter treks, hot springs, photography of snow-capped mountains</li>
                                        <li><strong>Summer:</strong> Trekking, camping, paragliding, river rafting, mountain biking, wildlife spotting</li>
                                        <li><strong>Monsoon:</strong> Indoor cultural experiences, spa retreats, photography (with caution due to landslides)</li>
                                    </ul>
                                {% elif single_place.State == "Rajasthan" or single_place.State == "Gujarat" %}
                                    <!-- Desert Region Activities -->
                                    <ul>
                                        <li><strong>Winter:</strong> Desert safaris, camel rides, cultural tours, fort visits, outdoor photography</li>
                                        <li><strong>Summer:</strong> Early morning/evening heritage walks, indoor museums, shopping for handicrafts, cultural performances</li>
                                        <li><strong>Monsoon:</strong> Bird watching, photography of desert landscapes turning green, cultural experiences</li>
                                    </ul>
                                {% elif single_place.State == "Kerala" or single_place.State == "Goa" %}
                                    <!-- Coastal Region Activities -->
                                    <ul>
                                        <li><strong>Winter:</strong> Beach activities, water sports, boat cruises, wildlife sanctuaries, cultural tours</li>
                                        <li><strong>Summer:</strong> Early morning beach walks, ayurvedic treatments, indoor cultural experiences, cooking classes</li>
                                        <li><strong>Monsoon:</strong> Ayurvedic treatments, watching the rain from seaside cafes, photography of lush landscapes</li>
                                    </ul>
                                {% elif single_place.Type == "Hill Station" %}
                                    <!-- Hill Station Activities -->
                                    <ul>
                                        <li><strong>Winter:</strong> Scenic viewpoints, nature walks, photography, local cuisine exploration</li>
                                        <li><strong>Summer:</strong> Trekking, boating, horseback riding, visiting tea/coffee plantations</li>
                                        <li><strong>Monsoon:</strong> Watching waterfalls, misty landscape photography, indoor cultural experiences</li>
                                    </ul>
                                {% elif single_place.Type == "Historical" or single_place.Type == "Heritage" %}
                                    <!-- Historical Site Activities -->
                                    <ul>
                                        <li><strong>Winter:</strong> Guided tours, architectural photography, light & sound shows, historical walks</li>
                                        <li><strong>Summer:</strong> Early morning/evening tours, museum visits, indoor historical sites</li>
                                        <li><strong>Monsoon:</strong> Photography of monuments against dramatic skies, indoor historical exhibits</li>
                                    </ul>
                                {% else %}
                                    <!-- Default Activities -->
                                    <ul>
                                        <li><strong>Winter:</strong> Sightseeing, photography, outdoor activities, local cuisine exploration</li>
                                        <li><strong>Summer:</strong> Indoor attractions, early morning/evening outings, cultural experiences</li>
                                        <li><strong>Monsoon:</strong> Lush landscape photography, indoor museums, cultural performances</li>
                                    </ul>
                                {% endif %}
                                
                                <div class="highlight-list mt-3">
                                    <span class="highlight-tag"><i class="fas fa-info-circle"></i> Activities may vary based on current weather conditions</span>
                                    <span class="highlight-tag"><i class="fas fa-calendar-check"></i> Check for seasonal closures before planning</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="region-content" id="festivals-content">
                            <div class="region-info">
                                <p>Major festivals and events in {{ single_place.State }} that might enhance your visit:</p>
                                
                                {% if single_place.State == "Rajasthan" %}
                                    <div class="festival-list">
                                        <div class="festival-item">
                                            <h4>Desert Festival (January/February)</h4>
                                            <p>Experience the vibrant culture of Jaisalmer with camel races, folk performances, and turban tying competitions.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Pushkar Camel Fair (November)</h4>
                                            <p>One of the world's largest camel fairs with trading, competitions, and cultural performances.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Teej (August)</h4>
                                            <p>Celebrates the arrival of monsoon with swings, traditional songs, and processions.</p>
                                        </div>
                                    </div>
                                {% elif single_place.State == "Kerala" %}
                                    <div class="festival-list">
                                        <div class="festival-item">
                                            <h4>Onam (August/September)</h4>
                                            <p>Kerala's harvest festival featuring boat races, floral decorations (pookalam), and the grand Onam Sadya feast.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Thrissur Pooram (April/May)</h4>
                                            <p>Spectacular temple festival with decorated elephants, traditional percussion, and fireworks.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Snake Boat Races (August-November)</h4>
                                            <p>Witness the famous Nehru Trophy Boat Race and other competitions on Kerala's backwaters.</p>
                                        </div>
                                    </div>
                                {% elif single_place.State == "Goa" %}
                                    <div class="festival-list">
                                        <div class="festival-item">
                                            <h4>Carnival (February/March)</h4>
                                            <p>Colorful parades, music, dance, and festivities before the Lenten season.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Shigmo (March)</h4>
                                            <p>Traditional spring festival with folk dances, street performances, and colorful processions.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Christmas & New Year (December)</h4>
                                            <p>Experience Goa's unique blend of Indian and Portuguese traditions with midnight mass, beach parties, and fireworks.</p>
                                        </div>
                                    </div>
                                {% elif single_place.State == "Himachal Pradesh" %}
                                    <div class="festival-list">
                                        <div class="festival-item">
                                            <h4>Kullu Dussehra (October)</h4>
                                            <p>Seven-day festival where local deities are brought in procession to pay homage to Lord Raghunath.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Winter Snow Festival (January)</h4>
                                            <p>Celebrated in Manali with skiing competitions, folk performances, and snow sculpture contests.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Mandi Shivratri Fair (March)</h4>
                                            <p>Week-long international fair with processions of local deities and cultural performances.</p>
                                        </div>
                                    </div>
                                {% elif single_place.State == "Tamil Nadu" %}
                                    <div class="festival-list">
                                        <div class="festival-item">
                                            <h4>Pongal (January)</h4>
                                            <p>Four-day harvest festival with special dishes, decorated cattle, and traditional games.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Madurai Chithirai Festival (April/May)</h4>
                                            <p>Grand celebration of the celestial wedding of Goddess Meenakshi and Lord Sundareswarar.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Dance Festival (December/January)</h4>
                                            <p>Classical dance performances at the ancient Mamallapuram monuments.</p>
                                        </div>
                                    </div>
                                {% elif single_place.State == "West Bengal" %}
                                    <div class="festival-list">
                                        <div class="festival-item">
                                            <h4>Durga Puja (September/October)</h4>
                                            <p>Bengal's biggest festival with elaborate pandals, cultural performances, and processions.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Poush Mela (December)</h4>
                                            <p>Traditional fair in Shantiniketan with folk music, Baul singers, and handicrafts.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Gangasagar Mela (January)</h4>
                                            <p>Pilgrimage and holy dip at the confluence of the Ganges and the Bay of Bengal.</p>
                                        </div>
                                    </div>
                                {% else %}
                                    <div class="festival-list">
                                        <div class="festival-item">
                                            <h4>Diwali (October/November)</h4>
                                            <p>Festival of lights celebrated with oil lamps, fireworks, and family gatherings.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Holi (March)</h4>
                                            <p>Festival of colors with water and colored powders, music, and traditional sweets.</p>
                                        </div>
                                        <div class="festival-item">
                                            <h4>Navratri (September/October)</h4>
                                            <p>Nine nights of dance and worship dedicated to the goddess Durga.</p>
                                        </div>
                                    </div>
                                {% endif %}
                                
                                <div class="highlight-list mt-4">
                                    <span class="highlight-tag"><i class="fas fa-calendar-alt"></i> Festival dates vary yearly (based on lunar calendar)</span>
                                    <span class="highlight-tag"><i class="fas fa-ticket-alt"></i> Book accommodations in advance during festivals</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Map & Locations Tab -->
            <div class="tab-content" id="map-locations-tab">
                <div class="map-locations-section">
                    <!-- Map Section -->
                    <div class="map-section-container">
                        <div class="section-header-enhanced">
                            <h3><i class="fas fa-map-marked-alt"></i> Interactive Map</h3>
                            <p>Explore {{ single_place.Name }} and its surroundings on the map below.</p>
                        </div>
                        <div class="map-container">
                            {% if single_place.map_url and single_place.map_url != "None" %}
                                <iframe src="{{ single_place.map_url }}" allowfullscreen="" loading="lazy"></iframe>
                            {% else %}
                                <div class="no-map-message">
                                    <i class="fas fa-map-marked-alt"></i>
                                    <p>Map is currently unavailable for this location.</p>
                                    <span class="map-note">We're working on adding an interactive map for this destination.</span>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Points of Interest and Travel Tips -->
                    <div class="location-info-container">
                        <!-- Nearby Points of Interest -->
                        <div class="nearby-section">
                            <div class="section-header-enhanced">
                                <h3><i class="fas fa-compass"></i> Nearby Points of Interest</h3>
                                <p>Discover what's around {{ single_place.Name }} to enhance your visit.</p>
                            </div>
                            <div class="tips-grid">
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-utensils"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h4>Restaurants</h4>
                                        <p>Discover local cuisine and dining options within walking distance.</p>
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-hotel"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h4>Accommodations</h4>
                                        <p>Find hotels, guesthouses, and homestays near {{ single_place.Name }}.</p>
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-shopping-bag"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h4>Shopping</h4>
                                        <p>Explore markets and shops for souvenirs and local crafts.</p>
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-bus"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h4>Transportation</h4>
                                        <p>Locate nearby bus stops, taxi stands, and transportation hubs.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Travel Tips -->
                        <div class="travel-tips-section">
                            <div class="section-header-enhanced">
                                <h3><i class="fas fa-lightbulb"></i> Travel Tips for {{ single_place.Name }}</h3>
                                <p>Make the most of your visit with these helpful suggestions.</p>
                            </div>
                            <div class="tips-grid">
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-map-signs"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h4>Getting Around</h4>
                                        <p>Explore the area on foot or use local transportation options for a more authentic experience.</p>
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-camera"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h4>Photography</h4>
                                        <p>The best spots for photos are during early morning or late afternoon when the lighting is ideal.</p>
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-umbrella"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h4>Weather Preparation</h4>
                                        <p>Check the forecast before your visit and dress accordingly for the local climate conditions.</p>
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-mobile-alt"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h4>Connectivity</h4>
                                        <p>Download offline maps and important information as network coverage may vary in some areas.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% include 'includes/footer.html' %}

    <script>
        // Function to normalize URLs by handling trailing slashes consistently
        function normalizeUrl(url) {
            // Remove trailing slash if it exists (except for root URL)
            if (url.length > 1 && url.endsWith('/')) {
                return url.slice(0, -1);
            }
            return url;
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // Tab functionality
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all buttons and contents
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Show corresponding content
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                    
                    // Update URL hash without affecting browser history
                    // This allows the back button to work properly
                    const newUrl = window.location.pathname + window.location.search + '#' + tabId;
                    window.history.replaceState(null, null, newUrl);
                });
            });
            
            // Handle URL hash on page load to restore tab state
            if (window.location.hash) {
                const tabId = window.location.hash.substring(1); // Remove the # character
                const tabButton = document.querySelector(`.tab-button[data-tab="${tabId}"]`);
                if (tabButton) {
                    // Simulate a click on the tab button
                    tabButton.click();
                }
            }
            
            // Region tabs functionality
            const regionTabs = document.querySelectorAll('.region-tab');
            const regionContents = document.querySelectorAll('.region-content');
            
            regionTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs and contents
                    regionTabs.forEach(t => t.classList.remove('active'));
                    regionContents.forEach(content => content.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Show corresponding content
                    const regionId = this.getAttribute('data-region');
                    document.getElementById(`${regionId}-content`).classList.add('active');
                    
                    // Update URL hash without affecting browser history
                    // This allows the back button to work properly
                    // We'll use region-{id} to differentiate from tabs
                    const currentHash = window.location.hash.split('&')[0]; // Keep the main tab
                    const newUrl = window.location.pathname + window.location.search + currentHash + '&region=' + regionId;
                    window.history.replaceState(null, null, newUrl);
                });
            });
            
            // Handle region parameter in URL hash on page load
            if (window.location.hash && window.location.hash.includes('&region=')) {
                const regionParam = window.location.hash.split('&region=')[1];
                const regionTab = document.querySelector(`.region-tab[data-region="${regionParam}"]`);
                if (regionTab) {
                    // Simulate a click on the region tab
                    regionTab.click();
                }
            }
            
            // Add CSS for the review elements
            const style = document.createElement('style');
            style.textContent = `
                .write-review-btn {
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    gap: 8px;
                    padding: 12px 20px;
                    background-color: #2e7d32;
                    color: white;
                    border: none;
                    border-radius: var(--border-radius);
                    font-weight: 500;
                    font-size: 15px;
                    cursor: pointer;
                    transition: var(--transition);
                    text-decoration: none;
                    box-shadow: 0 4px 10px rgba(46, 125, 50, 0.2);
                }
                
                .write-review-btn:hover {
                    background-color: #1b5e20;
                    transform: translateY(-2px);
                    box-shadow: 0 6px 15px rgba(46, 125, 50, 0.3);
                }
                
                .review-content h5 {
                    font-size: 18px;
                    margin-bottom: 10px;
                    color: var(--secondary-color);
                }
                
                .review-details {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                    gap: 10px;
                    margin-top: 15px;
                    background-color: var(--lightest-color);
                    padding: 15px;
                    border-radius: var(--border-radius);
                }
                
                @media (max-width: 576px) {
                    .review-details {
                        grid-template-columns: repeat(2, 1fr);
                    }
                    
                    .review-header {
                        flex-direction: column;
                        align-items: flex-start;
                        gap: 10px;
                    }
                    
                    .reviewer-info {
                        width: 100%;
                    }
                }
                
                .review-detail {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    font-size: 14px;
                    color: var(--text-light);
                }
                
                .review-detail i {
                    color: var(--primary-color);
                }
                
                .review-image {
                    margin-top: 15px;
                    border-radius: var(--border-radius);
                    overflow: hidden;
                    max-height: 300px;
                }
                
                .review-image img {
                    width: 100%;
                    height: 100%;
                    object-fit: cover;
                }
                
                .no-reviews {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    padding: 40px;
                    background-color: rgba(46, 125, 50, 0.05);
                    border: 1px dashed rgba(46, 125, 50, 0.3);
                    border-radius: var(--border-radius);
                    text-align: center;
                }
                
                .no-reviews i {
                    font-size: 48px;
                    color: #2e7d32;
                    margin-bottom: 15px;
                    opacity: 0.7;
                }
                
                .no-reviews p {
                    color: var(--text-color);
                    font-size: 16px;
                    margin-bottom: 10px;
                }
            `;
            document.head.appendChild(style);
            
            // Estimate Cost Button
            const estimateCostBtn = document.getElementById('estimateCostBtn');
            const costDisplay = document.getElementById('cost-display');
            const costLoader = document.querySelector('.cost-loader');
            const costResults = document.querySelector('.cost-results');
            
            if (estimateCostBtn) {
                estimateCostBtn.addEventListener('click', function() {
                    // Show cost display and loader
                    costDisplay.classList.add('show');
                    costLoader.style.display = 'flex';
                    costResults.innerHTML = '';
                    
                    // Get place ID from the page
                    const placeId = {{ single_place.id }};
                    
                    // Fetch cost data from the server
                    fetch(`/api/estimate-costs/${placeId}/`)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Network response was not ok');
                            }
                            return response.json();
                        })
                        .then(data => {
                            // Hide loader
                            costLoader.style.display = 'none';
                            
                            // Always show cost data (we now provide defaults even if no reviews)
                            // Populate results with data
                            costResults.innerHTML = `
                                <div class="cost-item">
                                    <h4><i class="fas fa-hotel"></i> Accommodation</h4>
                                    <p>₹${data.accommodation_cost.toFixed(0)} <span>per night</span></p>
                                </div>
                                <div class="cost-item">
                                    <h4><i class="fas fa-utensils"></i> Food</h4>
                                    <p>₹${data.food_cost.toFixed(0)} <span>per day</span></p>
                                </div>
                                <div class="cost-item">
                                    <h4><i class="fas fa-plane-departure"></i> Travel</h4>
                                    <p>₹${data.travel_cost.toFixed(0)} <span>average</span></p>
                                </div>
                                <div class="cost-item total-cost">
                                    <h4><i class="fas fa-coins"></i> Total Estimate</h4>
                                    <p>₹${(parseFloat(data.accommodation_cost) + parseFloat(data.food_cost) + parseFloat(data.travel_cost)).toFixed(0)} <span>per person</span></p>
                                </div>
                            `;
                            
                            // Add note about the source of data
                            const noteElement = document.createElement('div');
                            noteElement.className = 'cost-note';
                            
                            if (data.review_count > 0) {
                                noteElement.innerHTML = `
                                    <p><i class="fas fa-info-circle"></i> Based on ${data.review_count} user reviews. Actual costs may vary.</p>
                                `;
                            } else {
                                noteElement.innerHTML = `
                                    <p><i class="fas fa-info-circle"></i> These are estimated costs. Help others by <a href="{% url 'submit_trip_review' pk=single_place.id %}">submitting a review</a> with your actual expenses.</p>
                                `;
                            }
                            
                            costResults.appendChild(noteElement);
                        })
                        .catch(error => {
                            // Hide loader and show default cost estimates instead of error
                            costLoader.style.display = 'none';
                            
                            // Show default estimates even on error
                            costResults.innerHTML = `
                                <div class="cost-item">
                                    <h4><i class="fas fa-hotel"></i> Accommodation</h4>
                                    <p>₹1,500 <span>per night</span></p>
                                </div>
                                <div class="cost-item">
                                    <h4><i class="fas fa-utensils"></i> Food</h4>
                                    <p>₹800 <span>per day</span></p>
                                </div>
                                <div class="cost-item">
                                    <h4><i class="fas fa-plane-departure"></i> Travel</h4>
                                    <p>₹1,200 <span>average</span></p>
                                </div>
                                <div class="cost-item total-cost">
                                    <h4><i class="fas fa-coins"></i> Total Estimate</h4>
                                    <p>₹3,500 <span>per person</span></p>
                                </div>
                                
                                <div class="cost-note">
                                    <p><i class="fas fa-info-circle"></i> These are estimated costs. Help others by <a href="{% url 'submit_trip_review' pk=single_place.id %}">submitting a review</a> with your actual expenses.</p>
                                </div>
                            `;
                            
                            console.error('Error fetching cost data:', error);
                        });
                });
            }
        });
    </script>
</body>
</html>